var Kubox=function(){"use strict";function t(t){return t.replace(/[\s\t\n\-\_]+(\w)/g,function(t,e){return e.toUpperCase()})}var e=function(t,e){void 0===t&&(t={}),void 0===e&&(e={}),this.state=t,this.actions={},this.subscribers={},this.reducers(e)};return e.prototype.update=function(t){var e=this;if("object"==typeof t){var r=Object.keys(t);r.length&&(this.state=Object.assign({},this.state,t),r.concat("*").forEach(function(t){var r=e.subscribers[t]||[];r.forEach(function(t){return t(e.state)})}))}},e.prototype.subscribe=function t(e,r){if(void 0===r&&(r="*"),"function"==typeof e){var t=this.subscribers[r]=this.subscribers[r]||[];return t.push(e),function(){t.splice(t.indexOf(e)>>>0,1)}}},e.prototype.reducers=function(t,e){var r=this;if(void 0===e&&(e=""),"object"==typeof t)for(var n in t){var o=r.nameSpace(e,n),c=t[n];"object"==typeof c&&r.reducers(c,o),"function"==typeof c&&(r.actions[o]=r.createReducer(c,e))}},e.prototype.getState=function(t){return t?this.state[t]:this.state},e.prototype.nameSpace=function(e,r){return t(e+(e?" ":"")+r)},e.prototype.createReducer=function(t,e){var r=this;return function(){for(var n=[],o=arguments.length;o--;)n[o]=arguments[o];return r.recycle(t.apply(void 0,[r.getState(e)].concat(n)),function(t){var n;r.update(e?(n={},n[e]=t,n):t)},e)}},e.prototype.recycle=function(t,e,r){var n=this;if("object"==typeof t){if("function"==typeof t.then)return void t.then(function(t){return n.recycle(t,e,r)});if("function"==typeof t.next){var o=t.next(this.getState(r));return void(o.done||this.recycle(o.value,function(o){e(o),n.recycle(t,e,r)}))}}e(t)},e}();